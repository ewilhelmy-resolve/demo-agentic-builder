const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-nZV1BL2P.js","assets/index-D2g_LI3L.css"])))=>i.map(i=>d[i]);
import{r as s,j as e,c as _,I,n as k,o as S,p as O,q as j,R as f,E as b,s as E,t as T,u as V,v as P,w as q,x as F,y as L,D as R,b as A,d as H,e as M,f as U,O as B,_ as $}from"./index-nZV1BL2P.js";function o(n){return n.blob_metadata_id||n.blob_id}function G({sources:n,className:g,messageId:l}){const[C,d]=s.useState(!1),[a,c]=s.useState(null),[v,x]=s.useState(!1),m=async t=>{var u;const i=o(t);if(!i)return;x(!0),d(!0);const p=t.title||"Document";try{const{fileApi:r}=await $(async()=>{const{fileApi:w}=await import("./index-nZV1BL2P.js").then(D=>D.aN);return{fileApi:w}},__vite__mapDeps([0,1])),h=await r.getDocumentMetadata(i),y=((u=h.metadata)==null?void 0:u.content)||"Document content is being processed. Please try again later.";c({title:h.filename||p,content:y})}catch(r){console.error("Error loading document:",r),c({title:p,content:"Error loading document. Please try again."})}finally{x(!1)}console.log("Full document requested:",{messageId:l,sourceTitle:t.title,documentId:i,blob_metadata_id:t.blob_metadata_id,blob_id:t.blob_id,variant:"hover-card",timestamp:new Date().toISOString()})},N=n.map(t=>t.url).filter(t=>!!t);return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:_("not-prose inline-flex items-center gap-1",g),"data-message-id":l,children:e.jsx(I,{children:e.jsxs(k,{children:[e.jsx(S,{sources:N,className:"cursor-pointer"}),e.jsx(O,{children:n.length===1?e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx(j,{title:n[0].title,url:n[0].url}),n[0].snippet?e.jsx("blockquote",{className:"text-sm text-muted-foreground italic border-l-2 border-muted pl-3 py-1",children:n[0].snippet}):e.jsx("p",{className:"text-xs text-muted-foreground break-all",children:n[0].url}),n[0].content&&e.jsx("div",{className:"prose prose-xs dark:prose-invert max-w-none border-t border-border pt-3",children:e.jsx(f,{children:n[0].content})}),e.jsx("div",{className:"flex flex-col gap-2 pt-2",children:n[0].url?e.jsxs("a",{href:n[0].url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline inline-flex items-center gap-1",onClick:()=>{console.log("Citation clicked:",{messageId:l,sourceUrl:n[0].url,sourceTitle:n[0].title,variant:"hover-card",timestamp:new Date().toISOString()})},children:["View source",e.jsx(b,{className:"h-3 w-3"})]}):o(n[0])?e.jsx("button",{type:"button",onClick:()=>m(n[0]),className:"text-xs text-primary hover:underline inline-flex items-center gap-1 text-left",children:"View full document →"}):null})]}):e.jsxs(E,{children:[e.jsxs(T,{children:[e.jsx(V,{}),e.jsx(P,{}),e.jsx(q,{})]}),e.jsx(F,{children:n.map((t,i)=>e.jsxs(L,{children:[e.jsx(j,{title:t.title,url:t.url}),t.snippet?e.jsx("blockquote",{className:"text-sm text-muted-foreground italic border-l-2 border-muted pl-3 py-1 mt-2",children:t.snippet}):e.jsx("p",{className:"text-xs text-muted-foreground break-all mt-2",children:t.url}),t.content&&e.jsx("div",{className:"prose prose-xs dark:prose-invert max-w-none border-t border-border pt-3 mt-3",children:e.jsx(f,{children:t.content})}),e.jsx("div",{className:"flex flex-col gap-2 mt-2",children:t.url?e.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline inline-flex items-center gap-1",onClick:()=>{console.log("Citation clicked:",{messageId:l,sourceUrl:t.url,sourceTitle:t.title,variant:"hover-card",timestamp:new Date().toISOString()})},children:["View source",e.jsx(b,{className:"h-3 w-3"})]}):o(t)?e.jsx("button",{type:"button",onClick:()=>m(t),className:"text-xs text-primary hover:underline inline-flex items-center gap-1 text-left",children:"View full document →"}):null})]},`${l}-${i}`))})]})})]})})}),e.jsx(R,{open:C,onOpenChange:d,children:e.jsxs(A,{className:"sm:max-w-5xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(H,{children:[e.jsx(M,{children:(a==null?void 0:a.title)||"Document"}),e.jsx(U,{children:"Full document content"})]}),e.jsx("div",{className:"prose dark:prose-invert max-w-none",children:v?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):a!=null&&a.content?e.jsx(B,{children:a.content}):e.jsx("p",{className:"text-muted-foreground",children:"No content available"})})]})})]})}export{G as HoverCardCitations};
